<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Intro to Statistics with R</title>
  <meta name="description" content="Intro to Statistics with R">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Intro to Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Intro to Statistics with R" />
  
  
  

<meta name="author" content="Martin Morgan Martin.Morgan@RoswellPark.org &amp; Sean Davis seandavi@gmail.com">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="exploration-and-simple-univariate-measures.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html"><i class="fa fa-check"></i><b>1</b> Exploration and simple univariate measures</a><ul>
<li class="chapter" data-level="1.1" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html#clean-data"><i class="fa fa-check"></i><b>1.1</b> Clean data</a></li>
<li class="chapter" data-level="1.2" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html#weight-in-1990-vs.2010-females"><i class="fa fa-check"></i><b>1.2</b> Weight in 1990 vs. 2010 Females</a></li>
<li class="chapter" data-level="1.3" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html#weight-and-height-in-2010-males"><i class="fa fa-check"></i><b>1.3</b> Weight and height in 2010 Males</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>2</b> Multivariate analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#input-and-setup"><i class="fa fa-check"></i><b>2.1</b> Input and setup</a></li>
<li class="chapter" data-level="2.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#cleaning"><i class="fa fa-check"></i><b>2.2</b> Cleaning</a></li>
<li class="chapter" data-level="2.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#unsupervised-machine-learning-multi-dimensional-scaling"><i class="fa fa-check"></i><b>2.3</b> Unsupervised machine learning – multi-dimensional scaling</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate-analysis" class="section level1">
<h1><span class="header-section-number">2</span> Multivariate analysis</h1>
<p>This is a classic microarray experiment. Microarrays
consist of ‘probesets’ that interogate genes for their level of
expression. In the experiment we’re looking at, there are 12625
probesets measured on each of the 128 samples. The raw expression
levels estimated by microarray assays require considerable
pre-processing, the data we’ll work with has been pre-processed.</p>
<div id="input-and-setup" class="section level2">
<h2><span class="header-section-number">2.1</span> Input and setup</h2>
<p>Start by finding the expression data file on disk.</p>
<!--

-->
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">file.choose</span>()          <span class="co"># look for ALL-expression.csv</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">stopifnot</span>(<span class="kw">file.exists</span>(path))</a></code></pre></div>
<p>The data is stored in ‘comma-separate value’ format, with each
probeset occupying a line, and the expression value for each sample in
that probeset separated by a comma. Input the data using
<code>read.csv()</code>. There are three challenges:</p>
<ol style="list-style-type: decimal">
<li>The row names are present in the first column of the data. Tell <em>R</em>
this by adding the argument <code>row.names=1</code> to <code>read.csv()</code>.</li>
<li>By default, <em>R</em> checks that column names do not look like numbers,
but our column names <em>do</em> look like numbers. Use the argument
<code>check.colnames=FALSE</code> to over-ride <em>R</em>’s default.</li>
<li><code>read.csv()</code> returns a <code>data.frame</code>. We could use a <code>data.frame</code> to
work with our data, but really it is a <code>matrix()</code> – the columns
are of the same type and measure the same thing. Use <code>as.matrix()</code>
to coerce the <code>data.frame</code> we input to a <code>matrix</code>.</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">exprs &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path, <span class="dt">row.names=</span><span class="dv">1</span>, <span class="dt">check.names=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">exprs &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(exprs)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="kw">class</span>(exprs)</a></code></pre></div>
<pre><code>## [1] &quot;matrix&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">dim</span>(exprs)</a></code></pre></div>
<pre><code>## [1] 12625   128</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">exprs[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a></code></pre></div>
<pre><code>##              01005     01010    03002    04006    04007     04008
## 1000_at   7.597323  7.479445 7.567593 7.384684 7.905312  7.065914
## 1001_at   5.046194  4.932537 4.799294 4.922627 4.844565  5.147762
## 1002_f_at 3.900466  4.208155 3.886169 4.206798 3.416923  3.945869
## 1003_s_at 5.903856  6.169024 5.860459 6.116890 5.687997  6.208061
## 1004_at   5.925260  5.912780 5.893209 6.170245 5.615210  5.923487
## 1005_at   8.570990 10.428299 9.616713 9.937155 9.983809 10.063484
##               04010     04016    06002     08001
## 1000_at    7.474537  7.536119 7.183331  7.735545
## 1001_at    5.122518  5.016132 5.288943  4.633217
## 1002_f_at  4.150506  3.576360 3.900935  3.630190
## 1003_s_at  6.292713  5.665991 5.842326  5.875375
## 1004_at    6.046607  5.738218 5.994515  5.748350
## 1005_at   10.662059 11.269115 8.812869 10.165159</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">range</span>(exprs)</a></code></pre></div>
<pre><code>## [1]  1.984919 14.126571</code></pre>
<p>We’ll make use of the data describing the samples</p>
<!--

-->
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">file.choose</span>()         <span class="co"># look for ALL-phenoData.csv</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">stopifnot</span>(<span class="kw">file.exists</span>(path))</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">pdata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path, <span class="dt">row.names=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="kw">class</span>(pdata)</a></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">dim</span>(pdata)</a></code></pre></div>
<pre><code>## [1] 128  21</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">head</span>(pdata)</a></code></pre></div>
<pre><code>##        cod diagnosis sex age BT remission CR   date.cr t.4.11. t.9.22.
## 01005 1005 5/21/1997   M  53 B2        CR CR  8/6/1997   FALSE    TRUE
## 01010 1010 3/29/2000   M  19 B2        CR CR 6/27/2000   FALSE   FALSE
## 03002 3002 6/24/1998   F  52 B4        CR CR 8/17/1998      NA      NA
## 04006 4006 7/17/1997   M  38 B1        CR CR  9/8/1997    TRUE   FALSE
## 04007 4007 7/22/1997   M  57 B2        CR CR 9/17/1997   FALSE   FALSE
## 04008 4008 7/30/1997   M  17 B1        CR CR 9/27/1997   FALSE   FALSE
##       cyto.normal        citog mol.biol fusion.protein mdr   kinet   ccr
## 01005       FALSE      t(9;22)  BCR/ABL           p210 NEG dyploid FALSE
## 01010       FALSE  simple alt.      NEG           &lt;NA&gt; POS dyploid FALSE
## 03002          NA         &lt;NA&gt;  BCR/ABL           p190 NEG dyploid FALSE
## 04006       FALSE      t(4;11) ALL1/AF4           &lt;NA&gt; NEG dyploid FALSE
## 04007       FALSE      del(6q)      NEG           &lt;NA&gt; NEG dyploid FALSE
## 04008       FALSE complex alt.      NEG           &lt;NA&gt; NEG hyperd. FALSE
##       relapse transplant               f.u date.last.seen
## 01005   FALSE       TRUE BMT / DEATH IN CR           &lt;NA&gt;
## 01010    TRUE      FALSE               REL      8/28/2000
## 03002    TRUE      FALSE               REL     10/15/1999
## 04006    TRUE      FALSE               REL      1/23/1998
## 04007    TRUE      FALSE               REL      11/4/1997
## 04008    TRUE      FALSE               REL     12/15/1997</code></pre>
<p>Some of the results below involve plots, and it’s convenient to choose
pretty and functional colors. We use the <a href="https://cran.r-project.org/?package=RColorBrewer">RColorBrewer</a>
package; see <a href="http://colorbrewer.org">colorbrewer.org</a></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">library</span>(RColorBrewer)  ## not available? install package via RStudio</a>
<a class="sourceLine" id="cb37-2" data-line-number="2">highlight &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Set2&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a></code></pre></div>
<p>`highlight’ is a vector of length 2, light and dark green.</p>
<p>For more options see <code>?RColorBrewer</code> and to view the predefined
palettes <code>display.brewer.all()</code></p>
</div>
<div id="cleaning" class="section level2">
<h2><span class="header-section-number">2.2</span> Cleaning</h2>
<p>We’ll add a column to <code>pdata</code>, derived from the <code>BT</code> column, to
indicate whether the sample is B-cell or T-cell ALL.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">pdata<span class="op">$</span>BorT &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">substr</span>(pdata<span class="op">$</span>BT, <span class="dv">1</span>, <span class="dv">1</span>))</a></code></pre></div>
<p>Microarray expression data is usually represented as a matrix of genes
as rows and samples as columns. Statisticians usually think of their
data as samples as rows, features as columns. So we’ll transpose the
expression values</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">exprs &lt;-<span class="st"> </span><span class="kw">t</span>(exprs)</a></code></pre></div>
<p>Confirm that the <code>pdata</code> rows correspond to the <code>exprs</code> rows.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">stopifnot</span>(<span class="kw">identical</span>(<span class="kw">rownames</span>(pdata), <span class="kw">rownames</span>(exprs)))</a></code></pre></div>
</div>
<div id="unsupervised-machine-learning-multi-dimensional-scaling" class="section level2">
<h2><span class="header-section-number">2.3</span> Unsupervised machine learning – multi-dimensional scaling</h2>
<p>Reduce high-dimensional data to lower dimension for visualization.</p>
<p>Calculate distance between <em>samples</em> (requires that the expression
matrix be transposed).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">d &lt;-<span class="st"> </span><span class="kw">dist</span>(exprs)</a></code></pre></div>
<p>Use the <code>cmdscale()</code> function to summarize the distance matrix into
two points in two dimensions.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">cmd &lt;-<span class="st"> </span><span class="kw">cmdscale</span>(d)</a></code></pre></div>
<p>Visualize the result, coloring points by B- or T-cell status</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">plot</span>(cmd, <span class="dt">col=</span>highlight[pdata<span class="op">$</span>BorT])</a></code></pre></div>
<p><img src="D3_Statistics_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
</div>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-93043521-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
            </section>

          </div>
        </div>
      </div>
<a href="exploration-and-simple-univariate-measures.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/seandavi/ITR/edit/master/%s",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
