<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to R (ITR)</title>
  <meta name="description" content="Introduction to R (ITR)">
  <meta name="generator" content="bookdown 0.4.1 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to R (ITR)" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to R (ITR)" />
  
  
  

<meta name="author" content="Sean Davis">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="exploration-and-simple-univariate-measures.html">
<link rel="next" href="using-r-in-real-life.html">
<script src="book_assets/jquery-2.2.3/jquery.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Why R?</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-use-r"><i class="fa fa-check"></i><b>1.2</b> Why use R?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-not-use-r"><i class="fa fa-check"></i><b>1.3</b> Why not use R?</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#r-license-and-the-open-source-ideal"><i class="fa fa-check"></i><b>1.4</b> R License and the Open Source Ideal</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-mechanics.html"><a href="r-mechanics.html"><i class="fa fa-check"></i><b>2</b> R Mechanics</a><ul>
<li class="chapter" data-level="2.1" data-path="r-mechanics.html"><a href="r-mechanics.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="r-mechanics.html"><a href="r-mechanics.html#windows"><i class="fa fa-check"></i><b>2.1.1</b> Windows</a></li>
<li class="chapter" data-level="2.1.2" data-path="r-mechanics.html"><a href="r-mechanics.html#mac"><i class="fa fa-check"></i><b>2.1.2</b> Mac</a></li>
<li class="chapter" data-level="2.1.3" data-path="r-mechanics.html"><a href="r-mechanics.html#linux"><i class="fa fa-check"></i><b>2.1.3</b> Linux</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-mechanics.html"><a href="r-mechanics.html#starting-r"><i class="fa fa-check"></i><b>2.2</b> Starting R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>3</b> First steps</a><ul>
<li class="chapter" data-level="3.1" data-path="first-steps.html"><a href="first-steps.html#interacting-with-r"><i class="fa fa-check"></i><b>3.1</b> Interacting with R</a></li>
<li class="chapter" data-level="3.2" data-path="first-steps.html"><a href="first-steps.html#rules-for-names-in-r"><i class="fa fa-check"></i><b>3.2</b> Rules for Names in R</a></li>
<li class="chapter" data-level="3.3" data-path="first-steps.html"><a href="first-steps.html#resources-for-getting-help"><i class="fa fa-check"></i><b>3.3</b> Resources for Getting Help</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html"><i class="fa fa-check"></i><b>4</b> Introduction to R data structures</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a><ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#creating-vectors"><i class="fa fa-check"></i><b>4.1.1</b> Creating vectors</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#vector-operations"><i class="fa fa-check"></i><b>4.1.2</b> Vector Operations</a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#logical-vectors"><i class="fa fa-check"></i><b>4.1.3</b> Logical Vectors</a></li>
<li class="chapter" data-level="4.1.4" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#logical-operators"><i class="fa fa-check"></i><b>4.1.4</b> Logical Operators</a></li>
<li class="chapter" data-level="4.1.5" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#indexing-vectors"><i class="fa fa-check"></i><b>4.1.5</b> Indexing Vectors</a></li>
<li class="chapter" data-level="4.1.6" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#character-vectors-a.k.a.-strings"><i class="fa fa-check"></i><b>4.1.6</b> Character Vectors, A.K.A. Strings</a></li>
<li class="chapter" data-level="4.1.7" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#missing-values-aka-na"><i class="fa fa-check"></i><b>4.1.7</b> Missing Values, AKA “NA”</a></li>
<li class="chapter" data-level="4.1.8" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#factors"><i class="fa fa-check"></i><b>4.1.8</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#rectangular-data"><i class="fa fa-check"></i><b>4.2</b> Rectangular Data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#matrices"><i class="fa fa-check"></i><b>4.2.1</b> Matrices</a></li>
<li class="chapter" data-level="4.2.2" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#data-frames"><i class="fa fa-check"></i><b>4.2.2</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#basic-textual-input-and-output"><i class="fa fa-check"></i><b>4.3</b> Basic Textual Input and Output</a><ul>
<li class="chapter" data-level="4.3.1" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#reading-and-writing-data-frames-to-disk"><i class="fa fa-check"></i><b>4.3.1</b> Reading and Writing Data Frames to Disk</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#lists-and-objects"><i class="fa fa-check"></i><b>4.4</b> Lists and Objects</a><ul>
<li class="chapter" data-level="4.4.1" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#lists"><i class="fa fa-check"></i><b>4.4.1</b> Lists</a></li>
<li class="chapter" data-level="4.4.2" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#lists-in-practice"><i class="fa fa-check"></i><b>4.4.2</b> Lists in Practice</a></li>
<li class="chapter" data-level="4.4.3" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#lists-in-practice-1"><i class="fa fa-check"></i><b>4.4.3</b> Lists in Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html"><i class="fa fa-check"></i><b>5</b> Plotting and Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#basic-plot-functions"><i class="fa fa-check"></i><b>5.1</b> Basic Plot Functions</a><ul>
<li class="chapter" data-level="5.1.1" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#simple-plotting-example"><i class="fa fa-check"></i><b>5.1.1</b> Simple Plotting Example</a></li>
<li class="chapter" data-level="5.1.2" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#more-plotting"><i class="fa fa-check"></i><b>5.1.2</b> More Plotting</a></li>
<li class="chapter" data-level="5.1.3" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#more-plotting-1"><i class="fa fa-check"></i><b>5.1.3</b> More Plotting</a></li>
<li class="chapter" data-level="5.1.4" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#graphics-devices-and-saving-plots"><i class="fa fa-check"></i><b>5.1.4</b> Graphics Devices and Saving Plots</a></li>
<li class="chapter" data-level="5.1.5" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#more-plotting-2"><i class="fa fa-check"></i><b>5.1.5</b> More Plotting</a></li>
<li class="chapter" data-level="5.1.6" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#r-graphics-galleries-and-resources"><i class="fa fa-check"></i><b>5.1.6</b> R Graphics Galleries and Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html"><i class="fa fa-check"></i><b>6</b> Control Structures, Looping, and Applying</a><ul>
<li class="chapter" data-level="6.1" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#control-structures-and-looping"><i class="fa fa-check"></i><b>6.1</b> Control Structures and Looping</a><ul>
<li class="chapter" data-level="6.1.1" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#control-structures-in-r"><i class="fa fa-check"></i><b>6.1.1</b> Control Structures in R</a></li>
<li class="chapter" data-level="6.1.2" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#control-structure-and-looping-examples"><i class="fa fa-check"></i><b>6.1.2</b> Control Structure and Looping Examples</a></li>
<li class="chapter" data-level="6.1.3" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#control-structure-and-looping-examples-1"><i class="fa fa-check"></i><b>6.1.3</b> Control Structure and Looping Examples</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#applying"><i class="fa fa-check"></i><b>6.2</b> Applying</a><ul>
<li class="chapter" data-level="6.2.1" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#why-does-r-have-apply-functions"><i class="fa fa-check"></i><b>6.2.1</b> Why Does R Have Apply Functions</a></li>
<li class="chapter" data-level="6.2.2" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#apply-function-exercise"><i class="fa fa-check"></i><b>6.2.2</b> Apply Function Exercise</a></li>
<li class="chapter" data-level="6.2.3" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#related-apply-functions"><i class="fa fa-check"></i><b>6.2.3</b> Related Apply Functions</a></li>
<li class="chapter" data-level="6.2.4" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#related-apply-function-examples"><i class="fa fa-check"></i><b>6.2.4</b> Related Apply Function Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>7</b> Functions</a><ul>
<li class="chapter" data-level="7.0.1" data-path="functions.html"><a href="functions.html#function-overview"><i class="fa fa-check"></i><b>7.0.1</b> Function Overview</a></li>
<li class="chapter" data-level="7.0.2" data-path="functions.html"><a href="functions.html#example-functions"><i class="fa fa-check"></i><b>7.0.2</b> Example Functions</a></li>
<li class="chapter" data-level="7.0.3" data-path="functions.html"><a href="functions.html#further-reading"><i class="fa fa-check"></i><b>7.0.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rstudio-a-quick-tour.html"><a href="rstudio-a-quick-tour.html"><i class="fa fa-check"></i><b>8</b> <em>RStudio</em>: A Quick Tour</a></li>
<li class="chapter" data-level="9" data-path="r-first-impressions.html"><a href="r-first-impressions.html"><i class="fa fa-check"></i><b>9</b> <em>R</em>: First Impressions</a><ul>
<li class="chapter" data-level="9.1" data-path="r-first-impressions.html"><a href="r-first-impressions.html#r-data-types-vector-and-list"><i class="fa fa-check"></i><b>9.1</b> <em>R</em> Data types: vector and list</a></li>
<li class="chapter" data-level="9.2" data-path="r-first-impressions.html"><a href="r-first-impressions.html#classes-data.frame-and-beyond"><i class="fa fa-check"></i><b>9.2</b> Classes: data.frame and beyond</a></li>
<li class="chapter" data-level="9.3" data-path="r-first-impressions.html"><a href="r-first-impressions.html#help"><i class="fa fa-check"></i><b>9.3</b> Help!</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exercise-1-brfss-survey-data.html"><a href="exercise-1-brfss-survey-data.html"><i class="fa fa-check"></i><b>10</b> Exercise 1: BRFSS Survey Data</a></li>
<li class="chapter" data-level="11" data-path="exercise-2-all-phenotypic-data.html"><a href="exercise-2-all-phenotypic-data.html"><i class="fa fa-check"></i><b>11</b> Exercise 2: ALL Phenotypic Data</a></li>
<li class="chapter" data-level="12" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html"><i class="fa fa-check"></i><b>12</b> Exploration and simple univariate measures</a><ul>
<li class="chapter" data-level="12.1" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html#clean-data"><i class="fa fa-check"></i><b>12.1</b> Clean data</a></li>
<li class="chapter" data-level="12.2" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html#weight-in-1990-vs.2010-females"><i class="fa fa-check"></i><b>12.2</b> Weight in 1990 vs. 2010 Females</a></li>
<li class="chapter" data-level="12.3" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html#weight-and-height-in-2010-males"><i class="fa fa-check"></i><b>12.3</b> Weight and height in 2010 Males</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>13</b> Multivariate analysis</a><ul>
<li class="chapter" data-level="13.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#input-and-setup"><i class="fa fa-check"></i><b>13.1</b> Input and setup</a></li>
<li class="chapter" data-level="13.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#cleaning"><i class="fa fa-check"></i><b>13.2</b> Cleaning</a></li>
<li class="chapter" data-level="13.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#unsupervised-machine-learning-multi-dimensional-scaling"><i class="fa fa-check"></i><b>13.3</b> Unsupervised machine learning – multi-dimensional scaling</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="using-r-in-real-life.html"><a href="using-r-in-real-life.html"><i class="fa fa-check"></i><b>14</b> Using <em>R</em> in real life</a><ul>
<li class="chapter" data-level="14.1" data-path="using-r-in-real-life.html"><a href="using-r-in-real-life.html#organizing-work"><i class="fa fa-check"></i><b>14.1</b> Organizing work</a></li>
<li class="chapter" data-level="14.2" data-path="using-r-in-real-life.html"><a href="using-r-in-real-life.html#r-packages"><i class="fa fa-check"></i><b>14.2</b> <em>R</em> Packages</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="graphics-and-visualization.html"><a href="graphics-and-visualization.html"><i class="fa fa-check"></i><b>15</b> Graphics and Visualization</a><ul>
<li class="chapter" data-level="15.1" data-path="graphics-and-visualization.html"><a href="graphics-and-visualization.html#base-r-graphics"><i class="fa fa-check"></i><b>15.1</b> Base <em>R</em> Graphics</a></li>
<li class="chapter" data-level="15.2" data-path="graphics-and-visualization.html"><a href="graphics-and-visualization.html#what-makes-for-a-good-graphical-display"><i class="fa fa-check"></i><b>15.2</b> What makes for a good graphical display?</a></li>
<li class="chapter" data-level="15.3" data-path="graphics-and-visualization.html"><a href="graphics-and-visualization.html#grammar-of-graphics-ggplot2"><i class="fa fa-check"></i><b>15.3</b> Grammar of Graphics: ggplot2</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a-swirl.html"><a href="appendix-a-swirl.html"><i class="fa fa-check"></i><b>A</b> Appendix A – Swirl</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R (ITR)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate-analysis" class="section level1">
<h1><span class="header-section-number">13</span> Multivariate analysis</h1>
<p>This is a classic microarray experiment. Microarrays consist of ‘probesets’ that interogate genes for their level of expression. In the experiment we’re looking at, there are 12625 probesets measured on each of the 128 samples. The raw expression levels estimated by microarray assays require considerable pre-processing, the data we’ll work with has been pre-processed.</p>
<div id="input-and-setup" class="section level2">
<h2><span class="header-section-number">13.1</span> Input and setup</h2>
<p>Start by finding the expression data file on disk.</p>
<!--

-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">path &lt;-<span class="st"> </span><span class="kw">file.choose</span>()          <span class="co"># look for ALL-expression.csv</span>
<span class="kw">stopifnot</span>(<span class="kw">file.exists</span>(path))</code></pre></div>
<p>The data is stored in ‘comma-separate value’ format, with each probeset occupying a line, and the expression value for each sample in that probeset separated by a comma. Input the data using <code>read.csv()</code>. There are three challenges:</p>
<ol style="list-style-type: decimal">
<li>The row names are present in the first column of the data. Tell <em>R</em> this by adding the argument <code>row.names=1</code> to <code>read.csv()</code>.</li>
<li>By default, <em>R</em> checks that column names do not look like numbers, but our column names <em>do</em> look like numbers. Use the argument <code>check.colnames=FALSE</code> to over-ride <em>R</em>’s default.</li>
<li><code>read.csv()</code> returns a <code>data.frame</code>. We could use a <code>data.frame</code> to work with our data, but really it is a <code>matrix()</code> – the columns are of the same type and measure the same thing. Use <code>as.matrix()</code> to coerce the <code>data.frame</code> we input to a <code>matrix</code>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path, <span class="dt">row.names=</span><span class="dv">1</span>, <span class="dt">check.names=</span><span class="ot">FALSE</span>)
exprs &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(exprs)
<span class="kw">class</span>(exprs)</code></pre></div>
<pre><code>## [1] &quot;matrix&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(exprs)</code></pre></div>
<pre><code>## [1] 12625   128</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</code></pre></div>
<pre><code>##              01005     01010    03002    04006    04007     04008
## 1000_at   7.597323  7.479445 7.567593 7.384684 7.905312  7.065914
## 1001_at   5.046194  4.932537 4.799294 4.922627 4.844565  5.147762
## 1002_f_at 3.900466  4.208155 3.886169 4.206798 3.416923  3.945869
## 1003_s_at 5.903856  6.169024 5.860459 6.116890 5.687997  6.208061
## 1004_at   5.925260  5.912780 5.893209 6.170245 5.615210  5.923487
## 1005_at   8.570990 10.428299 9.616713 9.937155 9.983809 10.063484
##               04010     04016    06002     08001
## 1000_at    7.474537  7.536119 7.183331  7.735545
## 1001_at    5.122518  5.016132 5.288943  4.633217
## 1002_f_at  4.150506  3.576360 3.900935  3.630190
## 1003_s_at  6.292713  5.665991 5.842326  5.875375
## 1004_at    6.046607  5.738218 5.994515  5.748350
## 1005_at   10.662059 11.269115 8.812869 10.165159</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(exprs)</code></pre></div>
<pre><code>## [1]  1.984919 14.126571</code></pre>
<p>We’ll make use of the data describing the samples</p>
<!--

-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">path &lt;-<span class="st"> </span><span class="kw">file.choose</span>()         <span class="co"># look for ALL-phenoData.csv</span>
<span class="kw">stopifnot</span>(<span class="kw">file.exists</span>(path))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pdata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path, <span class="dt">row.names=</span><span class="dv">1</span>)
<span class="kw">class</span>(pdata)</code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(pdata)</code></pre></div>
<pre><code>## [1] 128  21</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(pdata)</code></pre></div>
<pre><code>##        cod diagnosis sex age BT remission CR   date.cr t.4.11. t.9.22.
## 01005 1005 5/21/1997   M  53 B2        CR CR  8/6/1997   FALSE    TRUE
## 01010 1010 3/29/2000   M  19 B2        CR CR 6/27/2000   FALSE   FALSE
## 03002 3002 6/24/1998   F  52 B4        CR CR 8/17/1998      NA      NA
## 04006 4006 7/17/1997   M  38 B1        CR CR  9/8/1997    TRUE   FALSE
## 04007 4007 7/22/1997   M  57 B2        CR CR 9/17/1997   FALSE   FALSE
## 04008 4008 7/30/1997   M  17 B1        CR CR 9/27/1997   FALSE   FALSE
##       cyto.normal        citog mol.biol fusion.protein mdr   kinet   ccr
## 01005       FALSE      t(9;22)  BCR/ABL           p210 NEG dyploid FALSE
## 01010       FALSE  simple alt.      NEG           &lt;NA&gt; POS dyploid FALSE
## 03002          NA         &lt;NA&gt;  BCR/ABL           p190 NEG dyploid FALSE
## 04006       FALSE      t(4;11) ALL1/AF4           &lt;NA&gt; NEG dyploid FALSE
## 04007       FALSE      del(6q)      NEG           &lt;NA&gt; NEG dyploid FALSE
## 04008       FALSE complex alt.      NEG           &lt;NA&gt; NEG hyperd. FALSE
##       relapse transplant               f.u date.last.seen
## 01005   FALSE       TRUE BMT / DEATH IN CR           &lt;NA&gt;
## 01010    TRUE      FALSE               REL      8/28/2000
## 03002    TRUE      FALSE               REL     10/15/1999
## 04006    TRUE      FALSE               REL      1/23/1998
## 04007    TRUE      FALSE               REL      11/4/1997
## 04008    TRUE      FALSE               REL     12/15/1997</code></pre>
<p>Some of the results below involve plots, and it’s convenient to choose pretty and functional colors. We use the <a href="https://cran.r-project.org/?package=RColorBrewer">RColorBrewer</a> package; see <a href="http://colorbrewer.org">colorbrewer.org</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RColorBrewer)  ## not available? install package via RStudio
highlight &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Set2&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</code></pre></div>
<p>`highlight’ is a vector of length 2, light and dark green.</p>
<p>For more options see <code>?RColorBrewer</code> and to view the predefined palettes <code>display.brewer.all()</code></p>
</div>
<div id="cleaning" class="section level2">
<h2><span class="header-section-number">13.2</span> Cleaning</h2>
<p>We’ll add a column to <code>pdata</code>, derived from the <code>BT</code> column, to indicate whether the sample is B-cell or T-cell ALL.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pdata<span class="op">$</span>BorT &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">substr</span>(pdata<span class="op">$</span>BT, <span class="dv">1</span>, <span class="dv">1</span>))</code></pre></div>
<p>Microarray expression data is usually represented as a matrix of genes as rows and samples as columns. Statisticians usually think of their data as samples as rows, features as columns. So we’ll transpose the expression values</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exprs &lt;-<span class="st"> </span><span class="kw">t</span>(exprs)</code></pre></div>
<p>Confirm that the <code>pdata</code> rows correspond to the <code>exprs</code> rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stopifnot</span>(<span class="kw">identical</span>(<span class="kw">rownames</span>(pdata), <span class="kw">rownames</span>(exprs)))</code></pre></div>
</div>
<div id="unsupervised-machine-learning-multi-dimensional-scaling" class="section level2">
<h2><span class="header-section-number">13.3</span> Unsupervised machine learning – multi-dimensional scaling</h2>
<p>Reduce high-dimensional data to lower dimension for visualization.</p>
<p>Calculate distance between <em>samples</em> (requires that the expression matrix be transposed).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="kw">dist</span>(exprs)</code></pre></div>
<p>Use the <code>cmdscale()</code> function to summarize the distance matrix into two points in two dimensions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cmd &lt;-<span class="st"> </span><span class="kw">cmdscale</span>(d)</code></pre></div>
<p>Visualize the result, coloring points by B- or T-cell status</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cmd, <span class="dt">col=</span>highlight[pdata<span class="op">$</span>BorT])</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploration-and-simple-univariate-measures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-r-in-real-life.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
