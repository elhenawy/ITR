<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>ITR.utf8</title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="ITR.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="ITR.utf8" />
  
  
  

<meta name="author" content="Sean Davis">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="exploration-and-simple-univariate-measures.html">
<link rel="next" href="using-r-in-real-life.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="why-r.html"><a href="why-r.html"><i class="fa fa-check"></i><b>1</b> Why R?</a><ul>
<li class="chapter" data-level="1.1" data-path="why-r.html"><a href="why-r.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="why-r.html"><a href="why-r.html#why-use-r"><i class="fa fa-check"></i><b>1.2</b> Why use R?</a></li>
<li class="chapter" data-level="1.3" data-path="why-r.html"><a href="why-r.html#why-not-use-r"><i class="fa fa-check"></i><b>1.3</b> Why not use R?</a></li>
<li class="chapter" data-level="1.4" data-path="why-r.html"><a href="why-r.html#r-license-and-the-open-source-ideal"><i class="fa fa-check"></i><b>1.4</b> R License and the Open Source Ideal</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-mechanics.html"><a href="r-mechanics.html"><i class="fa fa-check"></i><b>2</b> R Mechanics</a><ul>
<li class="chapter" data-level="2.1" data-path="r-mechanics.html"><a href="r-mechanics.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="r-mechanics.html"><a href="r-mechanics.html#windows"><i class="fa fa-check"></i><b>2.1.1</b> Windows</a></li>
<li class="chapter" data-level="2.1.2" data-path="r-mechanics.html"><a href="r-mechanics.html#mac"><i class="fa fa-check"></i><b>2.1.2</b> Mac</a></li>
<li class="chapter" data-level="2.1.3" data-path="r-mechanics.html"><a href="r-mechanics.html#linux"><i class="fa fa-check"></i><b>2.1.3</b> Linux</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-mechanics.html"><a href="r-mechanics.html#starting-r"><i class="fa fa-check"></i><b>2.2</b> Starting R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>3</b> First steps</a><ul>
<li class="chapter" data-level="3.1" data-path="first-steps.html"><a href="first-steps.html#interacting-with-r"><i class="fa fa-check"></i><b>3.1</b> Interacting with R</a></li>
<li class="chapter" data-level="3.2" data-path="first-steps.html"><a href="first-steps.html#rules-for-names-in-r"><i class="fa fa-check"></i><b>3.2</b> Rules for Names in R</a></li>
<li class="chapter" data-level="3.3" data-path="first-steps.html"><a href="first-steps.html#resources-for-getting-help"><i class="fa fa-check"></i><b>3.3</b> Resources for Getting Help</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html"><i class="fa fa-check"></i><b>4</b> Introduction to R data structures</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#vectors"><i class="fa fa-check"></i><b>4.1</b> Vectors</a><ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#creating-vectors"><i class="fa fa-check"></i><b>4.1.1</b> Creating vectors</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#vector-operations"><i class="fa fa-check"></i><b>4.1.2</b> Vector Operations</a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#logical-vectors"><i class="fa fa-check"></i><b>4.1.3</b> Logical Vectors</a></li>
<li class="chapter" data-level="4.1.4" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#logical-operators"><i class="fa fa-check"></i><b>4.1.4</b> Logical Operators</a></li>
<li class="chapter" data-level="4.1.5" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#indexing-vectors"><i class="fa fa-check"></i><b>4.1.5</b> Indexing Vectors</a></li>
<li class="chapter" data-level="4.1.6" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#character-vectors-a.k.a.-strings"><i class="fa fa-check"></i><b>4.1.6</b> Character Vectors, A.K.A. Strings</a></li>
<li class="chapter" data-level="4.1.7" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#missing-values-aka-na"><i class="fa fa-check"></i><b>4.1.7</b> Missing Values, AKA “NA”</a></li>
<li class="chapter" data-level="4.1.8" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#factors"><i class="fa fa-check"></i><b>4.1.8</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#rectangular-data"><i class="fa fa-check"></i><b>4.2</b> Rectangular Data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#matrices"><i class="fa fa-check"></i><b>4.2.1</b> Matrices</a></li>
<li class="chapter" data-level="4.2.2" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#data-frames"><i class="fa fa-check"></i><b>4.2.2</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-r-data-structures.html"><a href="introduction-to-r-data-structures.html#lists-and-objects"><i class="fa fa-check"></i><b>4.3</b> Lists and Objects</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html"><i class="fa fa-check"></i><b>5</b> Plotting and Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#base-r-graphics"><i class="fa fa-check"></i><b>5.1</b> Base R graphics</a></li>
<li class="chapter" data-level="5.2" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>5.2</b> Plotting with ggplot2</a><ul>
<li class="chapter" data-level="5.2.1" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#mtcars-data"><i class="fa fa-check"></i><b>5.2.1</b> mtcars data</a></li>
<li class="chapter" data-level="5.2.2" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#nyc-flight-data"><i class="fa fa-check"></i><b>5.2.2</b> NYC Flight data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="plotting-and-graphics.html"><a href="plotting-and-graphics.html#graphics-devices-and-saving-plots"><i class="fa fa-check"></i><b>5.3</b> Graphics Devices and Saving Plots</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html"><i class="fa fa-check"></i><b>6</b> Control Structures, Looping, and Applying</a><ul>
<li class="chapter" data-level="6.1" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#control-structures-and-looping"><i class="fa fa-check"></i><b>6.1</b> Control Structures and Looping</a><ul>
<li class="chapter" data-level="6.1.1" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#control-structures-in-r"><i class="fa fa-check"></i><b>6.1.1</b> Control Structures in R</a></li>
<li class="chapter" data-level="6.1.2" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#control-structure-and-looping-examples"><i class="fa fa-check"></i><b>6.1.2</b> Control Structure and Looping Examples</a></li>
<li class="chapter" data-level="6.1.3" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#control-structure-and-looping-examples-1"><i class="fa fa-check"></i><b>6.1.3</b> Control Structure and Looping Examples</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#applying"><i class="fa fa-check"></i><b>6.2</b> Applying</a><ul>
<li class="chapter" data-level="6.2.1" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#why-does-r-have-apply-functions"><i class="fa fa-check"></i><b>6.2.1</b> Why Does R Have Apply Functions</a></li>
<li class="chapter" data-level="6.2.2" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#apply-function-exercise"><i class="fa fa-check"></i><b>6.2.2</b> Apply Function Exercise</a></li>
<li class="chapter" data-level="6.2.3" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#related-apply-functions"><i class="fa fa-check"></i><b>6.2.3</b> Related Apply Functions</a></li>
<li class="chapter" data-level="6.2.4" data-path="control-structures-looping-and-applying.html"><a href="control-structures-looping-and-applying.html#related-apply-function-examples"><i class="fa fa-check"></i><b>6.2.4</b> Related Apply Function Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>7</b> Functions</a><ul>
<li class="chapter" data-level="7.1" data-path="functions.html"><a href="functions.html#function-overview"><i class="fa fa-check"></i><b>7.1</b> Function Overview</a></li>
<li class="chapter" data-level="7.2" data-path="functions.html"><a href="functions.html#example-functions"><i class="fa fa-check"></i><b>7.2</b> Example Functions</a></li>
<li class="chapter" data-level="7.3" data-path="functions.html"><a href="functions.html#further-reading"><i class="fa fa-check"></i><b>7.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-input-and-exploration.html"><a href="data-input-and-exploration.html"><i class="fa fa-check"></i><b>8</b> Data Input and Exploration</a><ul>
<li class="chapter" data-level="8.1" data-path="data-input-and-exploration.html"><a href="data-input-and-exploration.html#behavioral-risk-factor-surveillance-system"><i class="fa fa-check"></i><b>8.1</b> Behavioral Risk Factor Surveillance System</a><ul>
<li class="chapter" data-level="8.1.1" data-path="data-input-and-exploration.html"><a href="data-input-and-exploration.html#ggplot2"><i class="fa fa-check"></i><b>8.1.1</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data-input-and-exploration.html"><a href="data-input-and-exploration.html#all-phenotypic-data"><i class="fa fa-check"></i><b>8.2</b> ALL Phenotypic Data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html"><i class="fa fa-check"></i><b>9</b> Exploration and simple univariate measures</a><ul>
<li class="chapter" data-level="9.1" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html#clean-data"><i class="fa fa-check"></i><b>9.1</b> Clean data</a></li>
<li class="chapter" data-level="9.2" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html#weight-in-1990-vs.2010-females"><i class="fa fa-check"></i><b>9.2</b> Weight in 1990 vs. 2010 Females</a></li>
<li class="chapter" data-level="9.3" data-path="exploration-and-simple-univariate-measures.html"><a href="exploration-and-simple-univariate-measures.html#weight-and-height-in-2010-males"><i class="fa fa-check"></i><b>9.3</b> Weight and height in 2010 Males</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i><b>10</b> Multivariate analysis</a><ul>
<li class="chapter" data-level="10.1" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#input-and-setup"><i class="fa fa-check"></i><b>10.1</b> Input and setup</a></li>
<li class="chapter" data-level="10.2" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#cleaning"><i class="fa fa-check"></i><b>10.2</b> Cleaning</a></li>
<li class="chapter" data-level="10.3" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html#unsupervised-machine-learning-multi-dimensional-scaling"><i class="fa fa-check"></i><b>10.3</b> Unsupervised machine learning – multi-dimensional scaling</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="using-r-in-real-life.html"><a href="using-r-in-real-life.html"><i class="fa fa-check"></i><b>11</b> Using <em>R</em> in real life</a><ul>
<li class="chapter" data-level="11.1" data-path="using-r-in-real-life.html"><a href="using-r-in-real-life.html#organizing-work"><i class="fa fa-check"></i><b>11.1</b> Organizing work</a></li>
<li class="chapter" data-level="11.2" data-path="using-r-in-real-life.html"><a href="using-r-in-real-life.html#r-packages"><i class="fa fa-check"></i><b>11.2</b> <em>R</em> Packages</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="graphics-and-visualization.html"><a href="graphics-and-visualization.html"><i class="fa fa-check"></i><b>12</b> Graphics and Visualization</a><ul>
<li class="chapter" data-level="12.1" data-path="graphics-and-visualization.html"><a href="graphics-and-visualization.html#base-r-graphics-1"><i class="fa fa-check"></i><b>12.1</b> Base <em>R</em> Graphics</a></li>
<li class="chapter" data-level="12.2" data-path="graphics-and-visualization.html"><a href="graphics-and-visualization.html#what-makes-for-a-good-graphical-display"><i class="fa fa-check"></i><b>12.2</b> What makes for a good graphical display?</a></li>
<li class="chapter" data-level="12.3" data-path="graphics-and-visualization.html"><a href="graphics-and-visualization.html#grammar-of-graphics-ggplot2"><i class="fa fa-check"></i><b>12.3</b> Grammar of Graphics: ggplot2</a></li>
</ul></li>
<li class="part"><span><b>II Bioconductor</b></span></li>
<li class="chapter" data-level="13" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>13</b> Examples</a><ul>
<li class="chapter" data-level="13.1" data-path="examples.html"><a href="examples.html#geoquery-to-multidimensional-scaling"><i class="fa fa-check"></i><b>13.1</b> GEOquery to multidimensional scaling</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-data-sets.html"><a href="appendix-data-sets.html"><i class="fa fa-check"></i><b>A</b> Appendix – Data Sets</a></li>
<li class="chapter" data-level="B" data-path="appendix-swirl.html"><a href="appendix-swirl.html"><i class="fa fa-check"></i><b>B</b> Appendix – Swirl</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate-analysis" class="section level1">
<h1><span class="header-section-number">10</span> Multivariate analysis</h1>
<p>This is a classic microarray experiment. Microarrays
consist of ‘probesets’ that interogate genes for their level of
expression. In the experiment we’re looking at, there are 12625
probesets measured on each of the 128 samples. The raw expression
levels estimated by microarray assays require considerable
pre-processing, the data we’ll work with has been pre-processed.</p>
<div id="input-and-setup" class="section level2">
<h2><span class="header-section-number">10.1</span> Input and setup</h2>
<p>Start by finding the expression data file on disk.</p>
<!--

-->
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">file.choose</span>()          <span class="co"># look for ALL-expression.csv</span></a>
<a class="sourceLine" id="cb126-2" data-line-number="2"><span class="kw">stopifnot</span>(<span class="kw">file.exists</span>(path))</a></code></pre></div>
<p>The data is stored in ‘comma-separate value’ format, with each
probeset occupying a line, and the expression value for each sample in
that probeset separated by a comma. Input the data using
<code>read.csv()</code>. There are three challenges:</p>
<ol style="list-style-type: decimal">
<li>The row names are present in the first column of the data. Tell <em>R</em>
this by adding the argument <code>row.names=1</code> to <code>read.csv()</code>.</li>
<li>By default, <em>R</em> checks that column names do not look like numbers,
but our column names <em>do</em> look like numbers. Use the argument
<code>check.colnames=FALSE</code> to over-ride <em>R</em>’s default.</li>
<li><code>read.csv()</code> returns a <code>data.frame</code>. We could use a <code>data.frame</code> to
work with our data, but really it is a <code>matrix()</code> – the columns
are of the same type and measure the same thing. Use <code>as.matrix()</code>
to coerce the <code>data.frame</code> we input to a <code>matrix</code>.</li>
</ol>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1">exprs &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path, <span class="dt">row.names=</span><span class="dv">1</span>, <span class="dt">check.names=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb127-2" data-line-number="2">exprs &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(exprs)</a>
<a class="sourceLine" id="cb127-3" data-line-number="3"><span class="kw">class</span>(exprs)</a>
<a class="sourceLine" id="cb127-4" data-line-number="4">## [1] &quot;matrix&quot;</a>
<a class="sourceLine" id="cb127-5" data-line-number="5"><span class="kw">dim</span>(exprs)</a>
<a class="sourceLine" id="cb127-6" data-line-number="6">## [1] 12625   128</a>
<a class="sourceLine" id="cb127-7" data-line-number="7">exprs[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb127-8" data-line-number="8">##           01005 01010 03002 04006 04007 04008 04010 04016 06002 08001</a>
<a class="sourceLine" id="cb127-9" data-line-number="9">## 1000_at    7.60  7.48  7.57  7.38  7.91  7.07  7.47  7.54  7.18  7.74</a>
<a class="sourceLine" id="cb127-10" data-line-number="10">## 1001_at    5.05  4.93  4.80  4.92  4.84  5.15  5.12  5.02  5.29  4.63</a>
<a class="sourceLine" id="cb127-11" data-line-number="11">## 1002_f_at  3.90  4.21  3.89  4.21  3.42  3.95  4.15  3.58  3.90  3.63</a>
<a class="sourceLine" id="cb127-12" data-line-number="12">## 1003_s_at  5.90  6.17  5.86  6.12  5.69  6.21  6.29  5.67  5.84  5.88</a>
<a class="sourceLine" id="cb127-13" data-line-number="13">## 1004_at    5.93  5.91  5.89  6.17  5.62  5.92  6.05  5.74  5.99  5.75</a>
<a class="sourceLine" id="cb127-14" data-line-number="14">## 1005_at    8.57 10.43  9.62  9.94  9.98 10.06 10.66 11.27  8.81 10.17</a>
<a class="sourceLine" id="cb127-15" data-line-number="15"><span class="kw">range</span>(exprs)</a>
<a class="sourceLine" id="cb127-16" data-line-number="16">## [1]  1.98 14.13</a></code></pre></div>
<p>We’ll make use of the data describing the samples</p>
<!--

-->
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">file.choose</span>()         <span class="co"># look for ALL-phenoData.csv</span></a>
<a class="sourceLine" id="cb128-2" data-line-number="2"><span class="kw">stopifnot</span>(<span class="kw">file.exists</span>(path))</a></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1">pdata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(path, <span class="dt">row.names=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb129-2" data-line-number="2"><span class="kw">class</span>(pdata)</a>
<a class="sourceLine" id="cb129-3" data-line-number="3">## [1] &quot;data.frame&quot;</a>
<a class="sourceLine" id="cb129-4" data-line-number="4"><span class="kw">dim</span>(pdata)</a>
<a class="sourceLine" id="cb129-5" data-line-number="5">## [1] 128  21</a>
<a class="sourceLine" id="cb129-6" data-line-number="6"><span class="kw">head</span>(pdata)</a>
<a class="sourceLine" id="cb129-7" data-line-number="7">##        cod diagnosis sex age BT remission CR   date.cr t.4.11. t.9.22.</a>
<a class="sourceLine" id="cb129-8" data-line-number="8">## 01005 1005 5/21/1997   M  53 B2        CR CR  8/6/1997   FALSE    TRUE</a>
<a class="sourceLine" id="cb129-9" data-line-number="9">## 01010 1010 3/29/2000   M  19 B2        CR CR 6/27/2000   FALSE   FALSE</a>
<a class="sourceLine" id="cb129-10" data-line-number="10">## 03002 3002 6/24/1998   F  52 B4        CR CR 8/17/1998      NA      NA</a>
<a class="sourceLine" id="cb129-11" data-line-number="11">## 04006 4006 7/17/1997   M  38 B1        CR CR  9/8/1997    TRUE   FALSE</a>
<a class="sourceLine" id="cb129-12" data-line-number="12">## 04007 4007 7/22/1997   M  57 B2        CR CR 9/17/1997   FALSE   FALSE</a>
<a class="sourceLine" id="cb129-13" data-line-number="13">## 04008 4008 7/30/1997   M  17 B1        CR CR 9/27/1997   FALSE   FALSE</a>
<a class="sourceLine" id="cb129-14" data-line-number="14">##       cyto.normal        citog mol.biol fusion.protein mdr   kinet   ccr</a>
<a class="sourceLine" id="cb129-15" data-line-number="15">## 01005       FALSE      t(9;22)  BCR/ABL           p210 NEG dyploid FALSE</a>
<a class="sourceLine" id="cb129-16" data-line-number="16">## 01010       FALSE  simple alt.      NEG           &lt;NA&gt; POS dyploid FALSE</a>
<a class="sourceLine" id="cb129-17" data-line-number="17">## 03002          NA         &lt;NA&gt;  BCR/ABL           p190 NEG dyploid FALSE</a>
<a class="sourceLine" id="cb129-18" data-line-number="18">## 04006       FALSE      t(4;11) ALL1/AF4           &lt;NA&gt; NEG dyploid FALSE</a>
<a class="sourceLine" id="cb129-19" data-line-number="19">## 04007       FALSE      del(6q)      NEG           &lt;NA&gt; NEG dyploid FALSE</a>
<a class="sourceLine" id="cb129-20" data-line-number="20">## 04008       FALSE complex alt.      NEG           &lt;NA&gt; NEG hyperd. FALSE</a>
<a class="sourceLine" id="cb129-21" data-line-number="21">##       relapse transplant               f.u date.last.seen</a>
<a class="sourceLine" id="cb129-22" data-line-number="22">## 01005   FALSE       TRUE BMT / DEATH IN CR           &lt;NA&gt;</a>
<a class="sourceLine" id="cb129-23" data-line-number="23">## 01010    TRUE      FALSE               REL      8/28/2000</a>
<a class="sourceLine" id="cb129-24" data-line-number="24">## 03002    TRUE      FALSE               REL     10/15/1999</a>
<a class="sourceLine" id="cb129-25" data-line-number="25">## 04006    TRUE      FALSE               REL      1/23/1998</a>
<a class="sourceLine" id="cb129-26" data-line-number="26">## 04007    TRUE      FALSE               REL      11/4/1997</a>
<a class="sourceLine" id="cb129-27" data-line-number="27">## 04008    TRUE      FALSE               REL     12/15/1997</a></code></pre></div>
<p>Some of the results below involve plots, and it’s convenient to choose
pretty and functional colors. We use the <a href="https://cran.r-project.org/?package=RColorBrewer">RColorBrewer</a>
package; see <a href="http://colorbrewer.org">colorbrewer.org</a></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1"><span class="kw">library</span>(RColorBrewer)  ## not available? install package via RStudio</a>
<a class="sourceLine" id="cb130-2" data-line-number="2">highlight &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Set2&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a></code></pre></div>
<p>`highlight’ is a vector of length 2, light and dark green.</p>
<p>For more options see <code>?RColorBrewer</code> and to view the predefined
palettes <code>display.brewer.all()</code></p>
</div>
<div id="cleaning" class="section level2">
<h2><span class="header-section-number">10.2</span> Cleaning</h2>
<p>We’ll add a column to <code>pdata</code>, derived from the <code>BT</code> column, to
indicate whether the sample is B-cell or T-cell ALL.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1">pdata<span class="op">$</span>BorT &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">substr</span>(pdata<span class="op">$</span>BT, <span class="dv">1</span>, <span class="dv">1</span>))</a></code></pre></div>
<p>Microarray expression data is usually represented as a matrix of genes
as rows and samples as columns. Statisticians usually think of their
data as samples as rows, features as columns. So we’ll transpose the
expression values</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1">exprs &lt;-<span class="st"> </span><span class="kw">t</span>(exprs)</a></code></pre></div>
<p>Confirm that the <code>pdata</code> rows correspond to the <code>exprs</code> rows.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1"><span class="kw">stopifnot</span>(<span class="kw">identical</span>(<span class="kw">rownames</span>(pdata), <span class="kw">rownames</span>(exprs)))</a></code></pre></div>
</div>
<div id="unsupervised-machine-learning-multi-dimensional-scaling" class="section level2">
<h2><span class="header-section-number">10.3</span> Unsupervised machine learning – multi-dimensional scaling</h2>
<p>Reduce high-dimensional data to lower dimension for visualization.</p>
<p>Calculate distance between <em>samples</em> (requires that the expression
matrix be transposed).</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1">d &lt;-<span class="st"> </span><span class="kw">dist</span>(exprs)</a></code></pre></div>
<p>Use the <code>cmdscale()</code> function to summarize the distance matrix into
two points in two dimensions.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1">cmd &lt;-<span class="st"> </span><span class="kw">cmdscale</span>(d)</a></code></pre></div>
<p>Visualize the result, coloring points by B- or T-cell status</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1"><span class="kw">plot</span>(cmd, <span class="dt">col=</span>highlight[pdata<span class="op">$</span>BorT])</a></code></pre></div>
<p><img src="D3_Statistics_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>

</div>
</div>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-93043521-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
            </section>

          </div>
        </div>
      </div>
<a href="exploration-and-simple-univariate-measures.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-r-in-real-life.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/seandavi/ITR/edit/master/D3_Statistics.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
